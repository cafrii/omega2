'''
16933
ë²½ ë¶€ìˆ˜ê³  ì´ë™í•˜ê¸° 3

ìœ ì‚¬ ë¬¸ì œ
- 2206 ë²½ ë¶€ìˆ˜ê³  ì´ë™í•˜ê¸°
- 14442 ë²½ ë¶€ìˆ˜ê³  ì´ë™í•˜ê¸° 2
- 16933 ë²½ ë¶€ìˆ˜ê³  ì´ë™í•˜ê¸° 3
- 16946 ë²½ ë¶€ìˆ˜ê³  ì´ë™í•˜ê¸° 4

ì£¼ì˜
- ì´ ë¬¸ì œëŠ” Python3 ë¡œëŠ” ê±°ì˜ 100% timeout ë°œìƒí•¨. PyPy3 ë¡œ ì œì¶œí•  ê²ƒ!
- ì‹¤ì œë¡œ ì œì¶œëœ ë‹µì•ˆ ì¤‘ Python3 ë¡œ ì„±ê³µí•œ ì‚¬ë¡€ ì—†ìŒ.

ê°œì„  í•„ìš” ì‚¬í•­
- visit ì˜ êµ¬ì¡°ë¥¼ ê°œì„ í•˜ë©´ ì‹œê°„ ë‹¨ì¶•ì— ë„ì›€ì´ ë˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì„.
- ì§€ê¸ˆ ì½”ë“œëŠ” visited[y][x][day_or_night] ë¡œ ê´€ë¦¬. ê°’ì€ skill ìˆ˜.
- ìƒˆ ë°©ë²•ì€ visited[y][x][skill] ë¡œ ê´€ë¦¬í•˜ê³  ê°’ì€ walked.
  - ì´ë ‡ê²Œ í•˜ë©´ que ì— walked ë¥¼ ë„£ì§€ ì•Šì•„ë„ ë¨.



ë²½ ë¶€ìˆ˜ê³  ì´ë™í•˜ê¸° 3 ì„±ê³µ

ì‹œê°„ ì œí•œ	ë©”ëª¨ë¦¬ ì œí•œ	ì œì¶œ	ì •ë‹µ	ë§íŒ ì‚¬ëŒ	ì •ë‹µ ë¹„ìœ¨
2 ì´ˆ	512 MB	21746	5298	3468	22.826%


ë¬¸ì œ

NxMì˜ í–‰ë ¬ë¡œ í‘œí˜„ë˜ëŠ” ë§µì´ ìˆë‹¤. ë§µì—ì„œ 0ì€ ì´ë™í•  ìˆ˜ ìˆëŠ” ê³³ì„ ë‚˜íƒ€ë‚´ê³ , 1ì€ ì´ë™í•  ìˆ˜ ì—†ëŠ” ë²½ì´ ìˆëŠ” ê³³ì„ ë‚˜íƒ€ë‚¸ë‹¤.
ë‹¹ì‹ ì€ (1, 1)ì—ì„œ (N, M)ì˜ ìœ„ì¹˜ê¹Œì§€ ì´ë™í•˜ë ¤ í•˜ëŠ”ë°, ì´ë•Œ ìµœë‹¨ ê²½ë¡œë¡œ ì´ë™í•˜ë ¤ í•œë‹¤.
ìµœë‹¨ê²½ë¡œëŠ” ë§µì—ì„œ ê°€ì¥ ì ì€ ê°œìˆ˜ì˜ ì¹¸ì„ ì§€ë‚˜ëŠ” ê²½ë¡œë¥¼ ë§í•˜ëŠ”ë°, ì´ë•Œ ì‹œì‘í•˜ëŠ” ì¹¸ê³¼ ëë‚˜ëŠ” ì¹¸ë„ í¬í•¨í•´ì„œ ì„¼ë‹¤.
ì´ë™í•˜ì§€ ì•Šê³  ê°™ì€ ì¹¸ì— ë¨¸ë¬¼ëŸ¬ìˆëŠ” ê²½ìš°ë„ ê°€ëŠ¥í•˜ë‹¤.
ì´ ê²½ìš°ë„ ë°©ë¬¸í•œ ì¹¸ì˜ ê°œìˆ˜ê°€ í•˜ë‚˜ ëŠ˜ì–´ë‚˜ëŠ” ê²ƒìœ¼ë¡œ ìƒê°í•´ì•¼ í•œë‹¤.

ì´ë²ˆ ë¬¸ì œì—ì„œëŠ” ë‚®ê³¼ ë°¤ì´ ë²ˆê°ˆì•„ê°€ë©´ì„œ ë“±ì¥í•œë‹¤.
ê°€ì¥ ì²˜ìŒì— ì´ë™í•  ë•ŒëŠ” ë‚®ì´ê³ , í•œ ë²ˆ ì´ë™í•  ë•Œë§ˆë‹¤ ë‚®ê³¼ ë°¤ì´ ë°”ë€Œê²Œ ëœë‹¤.
ì´ë™í•˜ì§€ ì•Šê³  ê°™ì€ ì¹¸ì— ë¨¸ë¬´ë¥´ëŠ” ê²½ìš°ì—ë„ ë‚®ê³¼ ë°¤ì´ ë°”ë€Œê²Œ ëœë‹¤.

ë§Œì•½ì— ì´ë™í•˜ëŠ” ë„ì¤‘ì— ë²½ì„ ë¶€ìˆ˜ê³  ì´ë™í•˜ëŠ” ê²ƒì´ ì¢€ ë” ê²½ë¡œê°€ ì§§ì•„ì§„ë‹¤ë©´,
ë²½ì„ Kê°œ ê¹Œì§€ ë¶€ìˆ˜ê³  ì´ë™í•˜ì—¬ë„ ëœë‹¤. ë‹¨, ë²½ì€ ë‚®ì—ë§Œ ë¶€ìˆ  ìˆ˜ ìˆë‹¤.

í•œ ì¹¸ì—ì„œ ì´ë™í•  ìˆ˜ ìˆëŠ” ì¹¸ì€ ìƒí•˜ì¢Œìš°ë¡œ ì¸ì ‘í•œ ì¹¸ì´ë‹¤.

ë§µì´ ì£¼ì–´ì¡Œì„ ë•Œ, ìµœë‹¨ ê²½ë¡œë¥¼ êµ¬í•´ ë‚´ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì‹œì˜¤.

ì…ë ¥
ì²«ì§¸ ì¤„ì— N(1 â‰¤ N â‰¤ 1,000), M(1 â‰¤ M â‰¤ 1,000), K(1 â‰¤ K â‰¤ 10)ì´ ì£¼ì–´ì§„ë‹¤.
ë‹¤ìŒ Nê°œì˜ ì¤„ì— Mê°œì˜ ìˆ«ìë¡œ ë§µì´ ì£¼ì–´ì§„ë‹¤. (1, 1)ê³¼ (N, M)ì€ í•­ìƒ 0ì´ë¼ê³  ê°€ì •í•˜ì.

ì¶œë ¥
ì²«ì§¸ ì¤„ì— ìµœë‹¨ ê±°ë¦¬ë¥¼ ì¶œë ¥í•œë‹¤. ë¶ˆê°€ëŠ¥í•  ë•ŒëŠ” -1ì„ ì¶œë ¥í•œë‹¤.




'ë²½ì€ ë‚®ì—ë§Œ ë¶€ìˆ  ìˆ˜ ìˆë‹¤' ë¼ëŠ” ë§ì˜ í•´ì„
ë²½ì„ ë¶€ìˆ˜ëŠ” ì‘ì—…ì€ ë‹¹ì—°íˆ "ì´ë™í•˜ê¸° ì „ì— ë°œìƒ" í•´ì•¼ë§Œ í•œë‹¤. í•˜ì§€ë§Œ ì´ë™ê³¼ ë™ì‹œì— ë¶€ìˆœë‹¤ë¼ê³  ê°„ì£¼í•˜ëŠ” ê²ƒì´ í¸í•˜ë‹¤.
ì¼ë‹¨ ë‚® ìƒíƒœì—ì„œëŠ” ë²½ì„ ë¶€ìˆ  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒë§Œ í™•ì¸í•œ í›„,
ë‹¤ìŒ ëª©ì ì§€ê°€ ë²½ ì´ë©´ ë‚® -> ë°¤ìœ¼ë¡œ ë°”ë€” ë•Œ ë¶€ìˆ˜ê³  ì´ë™í•˜ë©´ ëœë‹¤.
ë‹¤ìŒ ëª©ì ì§€ê°€ ë²½ ì´ ì•„ë‹ ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ ë¯¸ë¦¬ ë¶€ìˆ´ë²„ë¦´ í•„ìš” ì—†ë‹¤.

walk             K
  ğŸŒ’   0 0 1 0   1
1 â˜€ï¸   A 0 1 0   1
2 ğŸŒ’   0 A 1 0   1 <- ë¶€ìˆ  ìˆ˜ ì—†ìŒ. stay í•´ì•¼ í•¨.
3 â˜€ï¸   0 A 1 0   1 <- ì´ì œ ë¶€ìˆ  ìˆ˜ ìˆìŒ.
4 ğŸŒ’   0 0 A 0   0
5 â˜€ï¸   0 0 0 A
# step 2 ì—ì„œ ë¶€ìˆ˜ì§€ ëª»í–ˆìŒ. stay í›„ step3 ê°€ ë‚®ì´ ë˜ì—ˆìœ¼ë‹ˆ ë¶€ìˆ  ìˆ˜ ìˆìŒ.
# í•˜ì§€ë§Œ step3 ì—ì„œ ë°”ë¡œ ë¶€ìˆ˜ì§€ ì•Šê³ , ëª©ì ì§€ê°€ ì •í•´ì§„ í›„ì— step4 ë¡œ ì´ë™í•  ë•Œ ë¶€ìˆ˜ë©´ ëœë‹¤.

  ğŸŒ’   0 1 0 0   1
1 â˜€ï¸   A 1 0 0   1
2 ğŸŒ’   0 A 0 0   0
3 â˜€ï¸   0 0 A 0
4 ğŸŒ’   0 0 0 A
# ìœ„ ê²½ìš°ëŠ” ë²½ì— ì¸ì ‘í•œ step1 ì´ ë‚®ì´ë¯€ë¡œ ë²½ì„ ë¶€ìˆ  ìˆ˜ ìˆëŠ” ìƒíƒœê°€ ë˜ì—ˆìŒ
# step2 ì—ì„œ ë²½ì„ ë¶€ìˆ˜ê³  (K ê°ì†Œ) ì´ë™í–ˆìŒ.
# step1 ì—ì„œ ë°”ë¡œ ë²½ì„ ë¶€ìˆ´ë²„ë¦¬ì§€ ì•ŠëŠ” ê²ƒì´ ì¤‘ìš”í•¨.
'''


import sys
from collections import deque

def log(fmt, *args):
    print(fmt % args, file=sys.stderr)

def solve(map1:list[str], K:int):
    '''
    ë²½ì„ ë¶€ìˆ˜ëŠ” ëŠ¥ë ¥ skill í•œë²ˆ ì“¸ ë•Œ ë§ˆë‹¤ 1ì”© ì†Œì§„.
    ì´ˆê¸°ê°’ K (Kë²ˆ ë¶€ìˆ  ìˆ˜ ìˆìŒ), ì‚¬ìš© ì‹œ ë§ˆë‹¤ -1 í•˜ì—¬ 0 ê¹Œì§€ ê°€ëŠ¥.
    '''
    N,M = len(map1),len(map1[0])

    que = deque()
    # que ì—ëŠ” (y,x,walked,skill)ê°€ ì¶”ê°€ë¨
    #    y,x ëŠ” ì¢Œí‘œ.
    #    walked ëŠ” "ì´ ì§€ì " ê¹Œì§€ì˜ ê±¸ìŒ ìˆ˜ (ìµœì´ˆ ì§€ì  í¬í•¨),
    #    skill ëŠ” ë²½ì„ ë¶€ìˆ˜ëŠ” íŠ¸ë¦­ ì‚¬ìš©ê¶Œ. ì•„ì§ ì‚¬ìš© ì•ˆí–ˆìœ¼ë©´ K, ëª¨ë‘ ë‹¤ ì‚¬ìš©í–ˆìœ¼ë©´ 0

    visited = [ [ [-1,-1] for x in range(M) ] for y in range(N) ]
    # ì˜ë¯¸: visited[y][x][day_or_night]
    # visited[y][x][day_or_night] ê°’ì˜ ì˜ë¯¸
    #    -1: ë°©ë¬¸í•˜ì§€ ì•ŠìŒ
    #     0: skillì„ ë‹¤ ì†Œì§„í•œ ìƒíƒœì—ì„œ ë°©ë¬¸í–ˆìŒ
    #     k: skillì´ kë²ˆ ë‚¨ì€ ìƒíƒœì—ì„œ ë°©ë¬¸
    #     K: skillì„ í•œë²ˆë„ ì“°ì§€ ì•Šì€ ìƒíƒœì—ì„œ ë°©ë¬¸
    # day_or_night:
    #     0: ë°¤ì— í•´ë‹¹ ì§€ì  ë°©ë¬¸
    #     1: ë‚®ì— í•´ë‹¹ ì§€ì  ë°©ë¬¸

    que.append((0, 0, 1, K)) # (0,0)ì—ì„œ ì‹œì‘. ì´ˆê¸° ê±¸ìŒìˆ˜ 1, ì”ì—¬ skill ìˆ˜ K.
        # ì²« ì´ë™ 1ì´ ë‚® ì´ë¼ê³  í–ˆìœ¼ë‹ˆ, í™€ìˆ˜ê°€ ë‚®ì´ë‹¤.
    visited[0][0][1] = K  # ì²˜ìŒ ì´ë™ì€ ë‚®.

    def questr(que):
        return ' '.join([ f'{y}/{x}/w{w}/{c}' for y,x,w,c in que ])

    stage = 1
    while que:
        log('Q: %s', questr(que)) # warning! it may cause timeout.

        y,x,walked,skill = que.popleft()
        if stage != walked:
            stage = walked
            log('------------------------- stage %d', stage)

        log(f'  ==> ({y},{x}) w{walked}, s{skill}, visited {visited[y][x]})')

        if (y,x) == (N-1,M-1):
            log('++++ finished! walked %d, remaining skill %d', walked, skill)
            return walked # chanceë¥¼ ì¼ë˜ ì•ˆì¼ë˜ ë¨¼ì € ë„ë‹¬í•˜ê¸°ë§Œ í•˜ë©´ ë¨.

        deltas = [(0,1),(1,0),(0,-1),(-1,0)]

        wall_adjacent = False
        for d in deltas:
            y2,x2 = y+d[0],x+d[1]
            if (not 0 <= y2 < N) or (not 0 <= x2 < M):
                continue

            if map1[y2][x2] == '1':
                wall_adjacent = True
                # ë²½ì´ì§€ë§Œ, ì•„ì§ skillì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ë©´ ì‚¬ìš©í•˜ë„ë¡ ì‹œë„í•  ìˆ˜ ìˆìŒ.
                if skill <= 0: # ë‚¨ì€ skill ì´ ì—†ë‹¤ë©´ ë¶ˆê°€ëŠ¥
                    continue
                if walked % 2 == 1: # í˜„ì¬ê°€ ë‚® ì¼ ë•Œë§Œ skill ì‚¬ìš© ê°€ëŠ¥
                    # ë” ì ì€ skill ì‚¬ìš©í•˜ì—¬ ì—¬ê¸°ì— ì´ë¯¸ ë„ë‹¬í–ˆì—ˆë‹¤ë©´ skip
                    if visited[y2][x2][0] >= skill-1:
                        continue
                    # skillì„ í•˜ë‚˜ ì†Œì§„í•œ í›„ ì´ë™ ê°€ëŠ¥.
                    que.append((y2,x2, walked+1, skill-1))
                    visited[y2][x2][0] = skill-1
            else:
                day = (walked+1) % 2 # ë‹¤ìŒ ì§€ì ì´ ë‚®ì´ë©´ 1, ë°¤ì´ë©´ 0
                # skillì„ ë” ì ê²Œ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ ë°©ë¬¸ì„ í–ˆë‹¤ë©´ ë” ì´ìƒ ë³¼ í•„ìš” ì—†ìŒ.
                if visited[y2][x2][day] >= skill:
                    continue
                que.append((y2,x2,walked+1,skill))
                visited[y2][x2][day] = skill

        # ì œìë¦¬ì— ë¨¸ë¬´ë¥´ëŠ” ê°€ëŠ¥ì„±ì´ ì¶”ê°€ë˜ì—ˆìŒ.
        if wall_adjacent and (walked % 2 == 0):
            # ì˜¤ì§ ë²½ì´ ì¸ì ‘í•´ ìˆì„ ë•Œ, ê·¸ë¦¬ê³  í˜„ì¬ê°€ ë°¤ì´ë¼ì„œ í•œë²ˆ stayí•˜ëŠ” ê²ƒì´ ì˜ë¯¸ê°€ ìˆì„ ë•Œë§Œ ê³ ë ¤.
            # skillì„ ë” ì ê²Œ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ ë°©ë¬¸ì„ í–ˆë‹¤ë©´ ë” ì´ìƒ ë³¼ í•„ìš” ì—†ìŒ.
            # í•œë²ˆ stay í•œ í›„ì—ë„ walked ëŠ” +1 ë˜ê³  ë°¤ë‚®ì€ ë°”ë€œ. ë”°ë¼ì„œ stay í›„ì—ëŠ” ë‚®.
            if visited[y][x][1] >= skill:
                continue
            que.append((y,x,walked+1,skill))
            visited[y][x][1] = skill

    return -1


input = sys.stdin.readline

N,M,K = map(int, input().rstrip().split())
map1 = [] # map
for _ in range(N):
    map1.append(input().rstrip()) # string with length M

# log('--------\n%s', '\n'.join(map1))
print(solve(map1,K))



'''
ì˜ˆì œ ì…ë ¥ 1
1 4 1
0010
ì˜ˆì œ ì¶œë ¥ 1
5


ì˜ˆì œ ì…ë ¥ 2
1 4 1
0100
ì˜ˆì œ ì¶œë ¥ 2
4

ì˜ˆì œ ì…ë ¥ 3
6 4 1
0100
1110
1000
0000
0111
0000
ì˜ˆì œ ì¶œë ¥ 3
15

ì˜ˆì œ ì…ë ¥ 4
6 4 2
0100
1110
1000
0000
0111
0000
ì˜ˆì œ ì¶œë ¥ 4
9

6 4 2
0010
1110
1000
0000
0111
0000
10

3 3 10
011
011
000
5

6 9 1
000000000
111111110
000000000
011110111
111101011
111111000
18

6 4 10
0111
1111
1111
1111
1111
1110
15

5 5 5
00100
11111
11111
11111
00000
11

'''
